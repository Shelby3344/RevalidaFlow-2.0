function f(i){const a=i.split(`
`).filter(t=>t.trim());let e="",r="";const o=[],l=[];let c="";for(const t of a)if(t.startsWith("Nível de atenção:"))e=t.replace("Nível de atenção:","").trim();else if(t.startsWith("Tipo de atendimento:"))r=t.replace("Tipo de atendimento:","").trim();else if(t.includes("infraestrutura:")||t.startsWith("A unidade"))c="situacao",o.push(t);else if(t.startsWith("Descrição do caso:")||t.startsWith("Descrição:")){c="descricao";const n=t.replace("Descrição do caso:","").replace("Descrição:","").trim();n&&l.push(n)}else t.startsWith("-")?c==="situacao"?o.push(t):l.push(t):c==="descricao"?l.push(t):c==="situacao"&&o.push(t);return{nivel:e,tipo:r,situacao:o,descricao:l}}function m(i){return i.split(`
`).map(a=>a.trim()).filter(a=>a.length>0).map(a=>a.startsWith("- ")?a:`- ${a}`)}function h(i){const a=i.split(`
`).filter(r=>r.trim()),e=[];for(const r of a){const o=r.replace(/\*\*/g,"").trim();o&&e.push(o)}return{titulo:"Script do Ator/Atriz",itens:e}}function g(i){const a=i.descricao.split(`
`).filter(d=>d.trim());let e="";const r=[];let o="",l="",c="";for(const d of a){const s=d.replace(/\*\*/g,"").trim();s.match(/^\d+\.\s/)?e=s:s.startsWith("(")&&s.match(/^\(\d+\)/)?r.push(s):s.startsWith("Adequado:")?o=s.replace("Adequado:","").trim():s.startsWith("Parcialmente adequado:")||s.startsWith("Parcialmente:")?l=s.replace("Parcialmente adequado:","").replace("Parcialmente:","").trim():s.startsWith("Inadequado:")&&(c=s.replace("Inadequado:","").trim())}const t=parseFloat(i.pontuacao.adequado)||1,n=i.pontuacao.parcial==="-"?0:parseFloat(i.pontuacao.parcial)||t/2;return{id:i.idx,title:e||`${i.idx}. Item de avaliação`,subItems:r,scoring:{adequate:o||"Realiza corretamente.",partial:l||"—",inadequate:c||"Não realiza."},scores:{min:0,partial:n,max:t},...i.dica_teorica?{dica_teorica:i.dica_teorica}:{}}}function W(i){const a=f(i.cenario);return{scenario:{nivel:a.nivel||"A definir",tipo:a.tipo||"A definir",situacao:a.situacao.length>0?a.situacao:["Cenário não especificado."],descricao:a.descricao.length>0?a.descricao:["Descrição não especificada."]},orientacoes:m(i.tarefas),instrucoes:h(i.script_ator),impressos:i.impressos.map(e=>({id:e.idx,title:`Impresso ${e.idx} – ${e.titulo}`,isOpen:!1,color:"bg-primary",content:e.conteudo,image:e.imagem})),evaluationItems:i.pep_items.map(g),references:[],definicao:i.definicao,resumo:i.resumo}}const u={},p={};async function q(i,a){const e=String(i);return u[e]?u[e]:(p[e]||(p[e]=(async()=>{try{const r=["CM","CR","GO","PE","PR"];for(const o of r)try{const l=await fetch(`/checklists-json/${o}/index.json`);if(l.ok){const c=await l.json();let t=c[e];if(!t&&a){const n=a.replace(/\s*\|\s*INEP\s*\d+\.?\d*/gi,"").replace(/[_\-–]/g," ").replace(/\s+/g," ").toLowerCase().trim();for(const[,d]of Object.entries(c)){const s=d.replace(/^\d+_/,"").replace(/\.json$/i,"").replace(/[_\-–]/g," ").replace(/\s*_?\s*INEP\s*\d+\.?\d*/gi,"").replace(/\s+/g," ").toLowerCase().trim();if(s===n||s.includes(n)||n.includes(s)){t=d;break}}}if(t){const n=await fetch(`/checklists-json/${o}/${t}`);if(n.ok){const d=await n.json(),s=W(d);return u[e]=s,s}}}}catch{}return null}catch(r){return console.error(`Erro ao carregar checklist ${e}:`,r),null}finally{delete p[e]}})()),p[e])}export{u as checklistCache,W as convertJsonToChecklistContent,q as loadChecklistByUidAsync};
