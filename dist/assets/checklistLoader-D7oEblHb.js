function f(t){const e=t.split(`
`).filter(i=>i.trim());let a="",r="";const s=[],n=[];let c="";for(const i of e)if(i.startsWith("Nível de atenção:"))a=i.replace("Nível de atenção:","").trim();else if(i.startsWith("Tipo de atendimento:"))r=i.replace("Tipo de atendimento:","").trim();else if(i.includes("infraestrutura:")||i.startsWith("A unidade"))c="situacao",s.push(i);else if(i.startsWith("Descrição do caso:")||i.startsWith("Descrição:")){c="descricao";const l=i.replace("Descrição do caso:","").replace("Descrição:","").trim();l&&n.push(l)}else i.startsWith("-")?c==="situacao"?s.push(i):n.push(i):c==="descricao"?n.push(i):c==="situacao"&&s.push(i);return{nivel:a,tipo:r,situacao:s,descricao:n}}function h(t){return t.split(`
`).map(e=>e.trim()).filter(e=>e.length>0).map(e=>e.startsWith("- ")?e:`- ${e}`)}function m(t){const e=t.split(`
`).filter(r=>r.trim()),a=[];for(const r of e){const s=r.replace(/\*\*/g,"").trim();s&&a.push(s)}return{titulo:"Script do Ator/Atriz",itens:a}}function g(t){const e=t.descricao.split(`
`).filter(d=>d.trim());let a="";const r=[];let s="",n="",c="";for(const d of e){const o=d.replace(/\*\*/g,"").trim();o.match(/^\d+\.\s/)?a=o:o.startsWith("(")&&o.match(/^\(\d+\)/)?r.push(o):o.startsWith("Adequado:")?s=o.replace("Adequado:","").trim():o.startsWith("Parcialmente adequado:")||o.startsWith("Parcialmente:")?n=o.replace("Parcialmente adequado:","").replace("Parcialmente:","").trim():o.startsWith("Inadequado:")&&(c=o.replace("Inadequado:","").trim())}const i=parseFloat(t.pontuacao.adequado)||1,l=t.pontuacao.parcial==="-"?0:parseFloat(t.pontuacao.parcial)||i/2;return{id:t.idx,title:a||`${t.idx}. Item de avaliação`,subItems:r,scoring:{adequate:s||"Realiza corretamente.",partial:n||"—",inadequate:c||"Não realiza."},scores:{min:0,partial:l,max:i},...t.dica_teorica?{dica_teorica:t.dica_teorica}:{}}}function W(t){const e=f(t.cenario);return{scenario:{nivel:e.nivel||"A definir",tipo:e.tipo||"A definir",situacao:e.situacao.length>0?e.situacao:["Cenário não especificado."],descricao:e.descricao.length>0?e.descricao:["Descrição não especificada."]},orientacoes:h(t.tarefas),instrucoes:m(t.script_ator),impressos:t.impressos.map(a=>({id:a.idx,title:`Impresso ${a.idx} – ${a.titulo}`,isOpen:!1,color:"bg-primary",content:a.conteudo,image:a.imagem})),evaluationItems:t.pep_items.map(g),references:[],definicao:t.definicao,resumo:t.resumo}}const p={},u={};async function q(t){const e=String(t);return p[e]?p[e]:(u[e]||(u[e]=(async()=>{try{const a=["CM","CR","GO","PE","PR"];for(const r of a)try{const s=await fetch(`/checklists-json/${r}/index.json`);if(s.ok){const c=(await s.json())[e];if(c){const i=await fetch(`/checklists-json/${r}/${c}`);if(i.ok){const l=await i.json(),d=W(l);return p[e]=d,d}}}}catch{}return null}catch(a){return console.error(`Erro ao carregar checklist ${e}:`,a),null}finally{delete u[e]}})()),u[e])}export{p as checklistCache,W as convertJsonToChecklistContent,q as loadChecklistByUidAsync};
